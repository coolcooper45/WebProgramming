<!DOCTYPE html>
<html lang="en">
<head>


    <!--Team: Paul Haines, Gabriel Shanahan, Peyton Whitefield-->


    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<!--CSS for Side navigation below-->
<style>
    button.link { background:none; border:none; }

    body {
      font-family: "Lato", sans-serif;
    }
    
    .sidebar {
      height: 100%;
      width: 0;
      position: fixed;
      z-index: 1;
      top: 0;
      left: 0;
      background-color: #111;
      overflow-x: hidden;
      transition: 0.5s;
      padding-top: 60px;
    }
    
    .sidebar a {
      padding: 8px 8px 8px 32px;
      text-decoration: none;
      font-size: 25px;
      color: #818181;
      display: block;
      transition: 0.3s;
    }
    
    .sidebar a:hover {
      color: #f1f1f1;
    }
    
    .sidebar .closebtn {
      position: absolute;
      top: 0;
      right: 25px;
      font-size: 36px;
      margin-left: 50px;
    }
    
    .openbtn {
      font-size: 20px;
      cursor: pointer;
      background-color: #111;
      color: white;
      padding: 10px 15px;
      border: none;
    }
    
    .openbtn:hover {
      background-color: #444;
    }
    
    #main {
      transition: margin-left .5s;
      padding: 16px;
    }

    .switch {
  position: relative;
  display: inline-block;
  width: 90px;
  height: 34px;
}

.switch input {display:none;}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ca2222;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2ab934;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(55px);
  -ms-transform: translateX(55px);
  transform: translateX(55px);
}

.on
{
  display: none;
}

.on, .off
{
  color: white;
  position: absolute;
  transform: translate(-50%,-50%);
  top: 50%;
  left: 50%;
  font-size: 10px;
  font-family: Verdana, sans-serif;
}

input:checked+ .slider .on
{display: block;}

input:checked + .slider .off
{display: none;}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;}
</style>

<body class="bg-primary vh-100">
    <!--Register Page Start*********-->
    <div class="card col-6 offset-3 mt-5" id="divRegister">
        <div class="card-header d-flex justify-content-center">
            <h3>Create New Account</h3>
        </div>
        <div class="card-body">
            <form class="needs-validation" novalidate>
                <div class="mt-1">
                    <input class="form-control" id="txtEmail" type="email" aria-label="Enter Email Address" placeholder="Email Address" required>
                    <div class="invalid-feedback">Invalid email address.</div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtPassword" type="password" aria-label="Enter Password" placeholder="Password" required>
                    <div class="invalid-feedback">You Must Enter a valid Password</div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtFirstName" type="text" aria-label="First Name" placeholder="First Name" required>
                    <div class="invalid-feedback">Please Enter Your First name </div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtLastName" type="text" aria-label="Last Name" placeholder="Last Name" required>
                    <div class="invalid-feedback">Please Enter Your Last name </div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtStreet1" type="text" aria-label="Street Adress 1" placeholder="Street Adress 1" required>
                    <div class="invalid-feedback">Please enter an Street 1 </div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtStreet2" type="text" aria-label="Street Adress 2" placeholder="Street Adress 2" required>
                    <div class="invalid-feedback">Please enter an Street 2 </div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtCity" type="text" aria-label="City" placeholder="City" required>
                    <div class="invalid-feedback">Please enter City </div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtState" type="text" aria-label="State" placeholder="State" required>
                    <div class="invalid-feedback">Please enter State </div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtZIP" type="text" aria-label="ZIP Code" placeholder="ZIP Code" required>
                    <div class="invalid-feedback">Please enter a ZIP Code </div>
                </div>

                <input type="checkbox" id="myCheck">
                <label for="myCheck">Is the COOP at a different location?</label><br>

            <div id="divSecondAddress" style="display:none">
                <div class="">
                    <input class="form-control" id="txtStreet3" type="text" aria-label="Street Adress 1" placeholder="Street Adress 1" required>
                    <div class="invalid-feedback">Please enter an Street 1 </div>
                </div>
                <div class="">
                    <input class="form-control" id="txtStreet4" type="text" aria-label="Street Adress 2" placeholder="Street Adress 2" required>
                    <div class="invalid-feedback">Please enter an Street 2 </div>
                </div>
                <div class="">
                    <input class="form-control" id="txtCityC" type="text" aria-label="City" placeholder="City" required>
                    <div class="invalid-feedback">Please enter City </div>
                </div>
                <div class="">
                    <input class="form-control" id="txtStateC" type="text" aria-label="State" placeholder="State" required>
                    <div class="invalid-feedback">Please enter State </div>
                </div>
                <div class="">
                    <input class="form-control" id="txtZIPC" type="text" aria-label="ZIP Code" placeholder="ZIP Code" required>
                    <div class="invalid-feedback">Please enter a ZIP Code </div>
                </div>
            </div>
            <div class="d-flex">
                <div class="col-4 p-2">
                    <button class="btn btn-primary mt-1 d-flex justify-content-center" type="button" id="btnRegister">Create User</button>
                </div>
                <div class="col-4 p-2">
                    <button class="btn btn-primary mt-1 d-flex justify-content-center" type="button" id="btnToLogin">Login in?</button>
                </div>
            </div>
            </form>
        </div>
    </div>
    <!--Register Page End************-->
    <!--Login Page Start*************-->
    <div class="card col-6 offset-3 mt-5" style="display: none;" id="divLogin">
        <div class="card-header d-flex justify-content-center">
            <h3>Login</h3>
        </div>
        <div class="card-body">
            <form class="needs-validation" novalidate>
                <div class="mt-1">
                    <input class="form-control" id="txtEmail2" type="email" aria-label="Enter Email Address" placeholder="Email Address" required>
                    <div class="invalid-feedback">Invalid email address.</div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtPassword2" type="password" aria-label="Enter Password" placeholder="Password" required>
                    <div class="invalid-feedback">Invalid Password</div>
                </div>
                <div class="d-flex">
                    <div class="col-4 p-2">
                        <button class="btn btn-primary col-8 mt-2 p-2 d-inline" type="button" id="btnLogin">Login</button>
                    </div>
                    <div class="col-4 p-2">
                        <button class="btn btn-primary col-8 mt-2 p-2" type="button" id="btnGoRegister">Register Account</button>
                    </div>
                    <div class="col-4 p-2">
                        <button class="btn btn-primary col-8 mt-2 p-2" type="button" id="btnForgotPassword">Forgot Password</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!--Login Page End*****************-->
    <!--Forgot Password Page Start*****-->
    <div class="card col-6 offset-3 mt-5" style="display: none;" id="divForgotPassword">
        <div class="card-header d-flex justify-content-center">
            <h3>Forgot Password</h3>
        </div>
        <div class="card-body">
            <form class="needs-validation" novalidate>
                <div class="mt-1">
                    <input class="form-control" id="txtEmail3" type="email" aria-label="Enter Email Address" placeholder="Email Address" required>
                    <div class="invalid-feedback">Invalid email address.</div>
                </div>
                <div class="mt-1">
                    <input class="form-control" id="txtNewPassword" type="text" aria-label="Enter New Password" placeholder="New Password" required>
                    <div class="invalid-feedback">Invalid Password.</div>
                </div>
                <div class="d-flex">
                    <div class="col-4 p-2">
                        <button class="btn btn-primary col-8 mt-2 p-2 d-inline" type="button" id="btnResetPassword">Reset Password</button>
                    </div>
                    <div class="col-4 p-2">
                        <button class="btn btn-primary col-8 mt-2 p-2" type="button" id="btnBack">Back</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!--Forgot Password Page End*****-->

    <!--Main Div after Login Start-->
    <div style="display: none;" id="divMain">

        <!--Sid-Bar Begin***********-->
        <div id="mySidebar" class="sidebar">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <div class="btn-group-vertical justify-content-center">
                <button class="link" style="border: none; color: lightgray; font-size: 24px;" id="btnDashboard">
                    <i class="fa-solid fa-house"></i>
                    Dashboard
                </button>
                <button class="link" style="border: none; color: lightgray; font-size: 24px;" id="btnSettings">
                    <i class="fa-solid fa-gear"></i>
                    Settings
                </button>
                <button class="link" style="border: none; color: lightgray; font-size: 24px;" id="btnWarnings">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    Warnings
                </button>
                <button class="link" style="border: none; color: lightgray; font-size: 20px;" id="btnLogOut">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    Log Out
                </button>
            </div>
        </div>
        <div id="main">
            <button class="openbtn" onclick="openNav()">&#9776;</button>
        </div>
        <!--Side-Bar End ************-->

        <!--Dashboard Div-->
        <div class="card col-6 offset-3 mt-5" id="divDashboard">
            <div class="card-header">
                <h3>Dashboard</h3>
            </div>
            <div class="row">
                <div class="col-3">
                    <div class="card">
                        <p class="d-flex justify-content-center">Eggs Harvested</p>
                        <h3 class="d-flex justify-content-center" id="txtEggCount"></h3>
                    </div>
                  </div>
                  <div class="col-3">
                    <div class="card">
                        <p class="d-flex justify-content-center">Current Temp</p>
                        <h3 class="d-flex justify-content-center" id="txtDegrees"></h3>
                    </div>
                  </div>
                  <div class="col-3">
                    <div class="card">
                        <p class="d-flex justify-content-center">Current Humidity</p>
                        <h3 class="d-flex justify-content-center" id="txtHumidity"></h3>
                    </div>
                  </div>
                  <div class="col-3">
                    <div class="card">
                        <p class="d-flex justify-content-center">Clean Day</p>
                        <h3 class="d-flex justify-content-center" id="txtCleanDays"></h3>
                    </div>
                  </div>
           </div>
           <div class="card-body">
            <h5 class="card-title">Last 7 Days Temperature & Humidity</h5>
            <canvas id="myTempChart" width="400" height="400"></canvas>
            <canvas id="myHumChart" width="400" height="400"></canvas>
          </div>
        </div>

        <!--Settings Div-->
        <div class="card col-6 offset-3 mt-5" style="display: none;" id="divSettings">

            <div id="divTimeSelection">
                <div class="mt-1" id="divOHour">
                    <label for="OHour">Open COOP Door Time:</label>
                    <input type="time" id="OHour" name="OHour" min="09:00" max="18:00" class="OHourEntry" required>
                    <button data-setting="OpenHour" class="btn btn-success" type="button" id="btnOSubmit">✓</button>
                </div>
                <div class="mt-1" id="divCHour">
                    <label for="CHour">Close COOP Door Time:</label>
                    <input type="time" id="CHour" name="CHour" min="09:00" max="18:00" class="CHourEntry" required>
                    <button data-setting="CloseHour" class="btn btn-success" type="button" id="btnCSubmit">✓</button>
                </div>
                <div class="mt-1" id="divOnLight">
                    <label for="OnLight">COOP Light On Time:</label>
                    <input type="time" id="onLight" name="onLight" min="09:00" max="18:00" class="onLightTimeEntry" required>
                    <button data-setting="OnLightTime" class="btn btn-success" type="button" id="btnOnLSubmit">✓</button>
                </div>
                <div class="mt-1" id="divOffLight">
                    <label for="OffLight">COOP Light Off Time:</label>
                    <input type="time" id="offLight" name="offLight" min="09:00" max="18:00" class="offLightTimeEntry" required>
                    <button data-setting="OffLightTime" class="btn btn-success" type="button" id="btnOffLSubmit">✓</button>
                </div>

                <div class="mt-1" id="divLowestTemp">
                    <label for="LowestTemp">Lowest Tempature of COOP:</label>
                    <input type="number" aria-label="Lowest Tempature" id="txtLowestTemp" class="lowestTempEntry" required>
                    <button data-setting="LowestTempature" class="btn btn-success" type="button" id="btnLowestTemp">✓</button>
                </div>
                <div class="mt-1" id="divHighestTemp">
                    <label for="HighestTemp">Highest Tempature of COOP:</label>
                    <input type="number" aria-label="Highest Tempature" id="txtHighestTemp" class="highestTempEntry" required>
                    <button data-setting="HighestTempature" class="btn btn-success" type="button" id="btnHighestTemp">✓</button>
                </div>
                <div class="input-group mb-3", id="divLowWaterPercent">
                    <label for="LowWaterPercent">Lowest Water Percentage:</label>
                    <input type="number" aria-label="Low Water Percent" id="numLowWaterPercent" class="lowWaterEntry" required>
                    <div class="input-group-append">
                        <span class="input-group-text">%</span>
                    </div>
                    <button data-setting="LowWater" class="btn btn-success" type="button" id="btnLowWaterPercent">✓</button>
                </div>
                <div class="input-group mb-3", id="divLowFoodPercent">
                    <label for="LowFoodPercent">Lowest Food Percentage:</label>
                    <input type="number" aria-label="Low Food Percent" id="numLowFoodPercent" class="lowFoodEntry" required>
                    <div class="input-group-append">
                        <span class="input-group-text">%</span>
                    </div>
                    <button data-setting="LowFood" class="btn btn-success" type="button" id="btnLowFoodPercent">✓</button>
                </div>

                <div class="mt-1" id="divToggleHeater">
                    <label>COOP Heater:</label>
                    <label class="switch">
                        <input type="checkbox" id="toggleHeater" data-toggle="collapse" data-target="#heaterCollapse">
                        <div class="slider round">
                            <span class="on">On</span>
                            <span class="off">Off</span>
                        </div>
                    </label>
                    <button data-setting="SwitchHeater" class="btn btn-success" type="button" id="btnHeater">✓</button>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="collapse" id="heaterCollapse">
                            <label for="HeaterTimer">Heater Timer:</label>
                            <input type="number" aria-label="Heater Timer" id="numHeaterTimer" class="heaterTimerEntry">
                            <button data-setting="SwitchHeaterTime" class="btn btn-success" type="button" id="btnHeaterTimer">✓</button>
                        </div>
                    </div>
                </div>
                <div class="mt-1" id="divToggleFan">
                    <label>COOP Fan:</label>
                    <label class="switch">
                        <input type="checkbox" id="toggleFan" data-toggle="collapse" data-target="#fanCollapse">
                        <div class="slider round">
                            <span class="on">On</span>
                            <span class="off">Off</span>
                        </div>
                    </label>
                    <button data-setting="SwitchFan" class="btn btn-success" type="button" id="btnFan">✓</button>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="collapse" id="fanCollapse">
                            <label for="FanTimer">Fan Timer:</label>
                            <input type="number" aria-label="Fan Timer" id="numFanTimer" class="fanTimerEntry">
                            <button data-setting="SwitchFanTime" class="btn btn-success" type="button" id="btnFanTimer">✓</button>
                        </div>
                    </div>
                </div>

                <div class="mt-1" id="divToggleDoor">
                    <label>COOP Door:</label>
                    <label class="switch">
                        <input type="checkbox" id="btnToggleDoor">
                        <div class="slider round">
                         <span class="on">Open</span>
                         <span class="off">Close</span>
                        </div>
                    </label>
                    <button data-setting="SwitchDoor" class="btn btn-success" type="button" id="btnDoor">✓</button>
                </div>
                <div class="mt-1" id="divToggleLight">
                    <label>COOP Light:</label>
                    <label class="switch">
                        <input type="checkbox" id="btnToggleLight">
                        <div class="slider round">
                         <span class="on">ON</span>
                         <span class="off">OFF</span>
                        </div>
                    </label>
                    <button data-setting="SwitchLight" class="btn btn-success" type="button" id="btnLight">✓</button>
                </div>
            </div>

        </div>
        

    </div>
    <!--Main Div after Settings End-->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.0/dist/sweetalert2.all.min.js" integrity="sha256-m/sZMbDLng35+odvNDecxhKoxkVCYvbe83s22M79WgU=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        function openNav() {
          document.getElementById("mySidebar").style.width = "250px";
          document.getElementById("main").style.marginLeft = "250px";
        }
        
        function closeNav() {
          document.getElementById("mySidebar").style.width = "0";
          document.getElementById("main").style.marginLeft= "0";
        }

        function isValidPassword(strPasswordT){
                let regPassword = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,64}$/;
                return regPassword.test(strPasswordT);
            }
        function isValidEmail(strEmailAddress){
            let regEmail = /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;
                return regEmail.test(strEmailAddress);
        }
    </script>
    <script>
        
        $('#btnToLogin').on('click', function() {
            $('#divRegister').slideToggle();
            $('#divLogin').slideToggle();
        })

        $('#btnGoRegister').on('click', function() {
            $('#divLogin').slideToggle();
            $('#divRegister').slideToggle();
        })

        $('#btnForgotPassword').on('click', function() {
            $('#divLogin').slideToggle();
            $('#divForgotPassword').slideToggle();
        })

        $('#btnBack').on('click',function(){
            $('#divForgotPassword').slideToggle();
            $('#divLogin').slideToggle();
        })

        $('#btnDashboard').on('click',function(){
            $('#divDashboard').slideDown();
            $('#divSettings').slideUp();
        })

        $('#btnSettings').on('click',function(){
            $('#divSettings').slideDown();
            $('#divDashboard').slideUp();
        })

        //Settings manual input below

        $('#btnOSubmit').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.OHourEntry').val();
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })     

        $('#btnCSubmit').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.CHourEntry').val();
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })     

        $('#btnOnLSubmit').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.onLightTimeEntry').val();
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })     

        $('#btnOffLSubmit').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.offLightTimeEntry').val();
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })     


        $('#btnLowestTemp').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.lowestTempEntry').val();
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })     

        $('#btnHighestTemp').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.highestTempEntry').val();
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })     

        $('#btnLowWaterPercent').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.lowWaterEntry').val();
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })     

        $('#btnLowFoodPercent').on('click','.btnLowFoodPercent',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.lowFoodEntry').val();
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })        

        $('#btnHeaterTimer').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.HeaterTimerEntry').val();
            let Timer = $('#numHeaterTimer').val() * 100000;
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
            const heaterTimeout = setTimeout(heaterTimer, Timer);
            function heaterTimer() {
                $('#toggleHeater').prop('checked', false);
                $('#heaterCollapse').collapse("toggle");
            }
        })     

        $('#btnFanTimer').on('click',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $(this).closest('.fanTimerEntry').val();
            let Timer2 = $('#numFanTimer').val() * 100000;
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
            const fanTimeout = setTimeout(fanTimer, Timer2);
            function fanTimer() {
                $('#toggleFan').prop('checked', false);
                $('#fanCollapse').collapse("toggle");
            }
        })

        //Settings sliders below

        $('#btnHeater').on('click','.btnLowFoodPercent',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $('#btnToggleHeater').prop('checked');
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })  

        $('#btnFan').on('click','.btnLowFoodPercent',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $('#btnToggleFan').prop('checked');
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })  

        $('#btnDoor').on('click','.btnLowFoodPercent',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $('#btnToggleDoor').prop('checked');
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })  

        $('#btnLight').on('click','.btnLowFoodPercent',function(){
            let strSetting = $(this).attr('data-setting');
            let strValue = $('#btnToggleLight').prop('checked');
            $.post('https://simplecoop.swollenhippo.com/settings.php',{SessionID: sessionStorage.getItem('SessionID'), setting: strSetting, value: strValue})
        })  
                    
        $('#btnWarnings').on('click',function(){
            Swal.fire({
                icon: 'warning',
                title: 'Warnings',
                text: 'Insert warnings here'
            })
        })
        $('#btnLogOut').on('click',function(){
            sessionStorage.removeItem('SessionID');
            $('#divSettings').slideUp();
            $('#divDashboard').slideUp();
            $('#divMain').hide();
            closeNav();
            $('#divLogin').slideDown();
        })

        $('#myCheck').on('click',function(){
            var checkBox = document.getElementById("myCheck");
            if (checkBox.checked == true){
                divSecondAddress.style.display = "block";
                $('#txtStreet3').removeClass('is-invalid');
                $('#txtStreet4').removeClass('is-invalid');
                $('#txtCityC').removeClass('is-invalid');
                $('#txtStateC').removeClass('is-invalid');
                $('#txtZIPC').removeClass('is-invalid');
                $('#txtStreet3').removeClass('is-valid');
                $('#txtStreet4').removeClass('is-valid');
                $('#txtCityC').removeClass('is-valid');
                $('#txtStateC').removeClass('is-valid');
                $('#txtZIPC').removeClass('is-valid');

            } else {
                divSecondAddress.style.display = "none";
                $('#txtStreet3').removeClass('is-invalid');
                $('#txtStreet4').removeClass('is-invalid');
                $('#txtCityC').removeClass('is-invalid');
                $('#txtStateC').removeClass('is-invalid');
                $('#txtZIPC').removeClass('is-invalid');
                $('#txtStreet3').removeClass('is-valid');
                $('#txtStreet4').removeClass('is-valid');
                $('#txtCityC').removeClass('is-valid');
                $('#txtStateC').removeClass('is-valid');
                $('#txtZIPC').removeClass('is-valid');
            }
        })

        $('#myCheck').on('click',function(){
            var checkBox = document.getElementById("myCheck");
            if (checkBox.checked == true){
                divSecondAddress.style.display = "block";
                $('#txtStreet3').removeClass('is-invalid');
                $('#txtStreet4').removeClass('is-invalid');
                $('#txtCityC').removeClass('is-invalid');
                $('#txtStateC').removeClass('is-invalid');
                $('#txtZIPC').removeClass('is-invalid');
                $('#txtStreet3').removeClass('is-valid');
                $('#txtStreet4').removeClass('is-valid');
                $('#txtCityC').removeClass('is-valid');
                $('#txtStateC').removeClass('is-valid');
                $('#txtZIPC').removeClass('is-valid');

            } else {
                divSecondAddress.style.display = "none";
                $('#txtStreet3').removeClass('is-invalid');
                $('#txtStreet4').removeClass('is-invalid');
                $('#txtCityC').removeClass('is-invalid');
                $('#txtStateC').removeClass('is-invalid');
                $('#txtZIPC').removeClass('is-invalid');
                $('#txtStreet3').removeClass('is-valid');
                $('#txtStreet4').removeClass('is-valid');
                $('#txtCityC').removeClass('is-valid');
                $('#txtStateC').removeClass('is-valid');
                $('#txtZIPC').removeClass('is-valid');
            }
        })

        $('#btnRegister').on('click',function(){

            let strEmail = $('#txtEmail').val();
            let strPassword = $('#txtPassword').val();
            let strFirstName = $('#txtFirstName').val();
            let strLastName = $('#txtLastName').val();
            let strStreet1 = $('#txtStreet1').val();
            let strStreet2 = $('#txtStreet2').val();
            let strCity = $('#txtCity').val();
            let strState = $('#txtState').val();
            let strZip = $('#txtZIP').val();
            let strCoopID = '';
            
            var checkBox = document.getElementById("myCheck");
            var passCheck = isValidPassword(strPassword);
            var emailCheck = isValidEmail(strEmail);

            
            let strStreet3;
            let strStreet4;
            let strCityC;
            let strStateC;
            let strZipC;
            
            if (checkBox.checked == true) {
                strStreet3 = $('#txtStreet3').val();
                strStreet4 = $('#txtStreet4').val();
                strCityC = $('#txtCityC').val();
                strStateC = $('#txtStateC').val();
                strZipC = $('#txtZIPC').val();
            }
            else {
                strStreet3 = $('#txtStreet1').val();
                strStreet4 = $('#txtStreet2').val();
                strCityC = $('#txtCity').val();
                strStateC = $('#txtState').val();
                strZipC = $('#txtZIP').val();
            }
            
            let blnError = false;
            let strErrorMessage = '';
            let frmNewUser = document.querySelector('form');
            frmNewUser.reportValidity();
            
            if(emailCheck == false){
                blnError = true;
                $('#txtEmail').addClass('is-invalid');
            }
            else if(passCheck == false){
                blnError = true;
                $('#txtPassword').addClass('is-invalid');
            }
            else if(!strFirstName){
                blnError = true;
                $('#txtFirstName').addClass('is-invalid');
            }
            else if(!strLastName){
                blnError = true;
                $('#txtLastName').addClass('is-invalid');
            }
            else if(!strStreet1){
                blnError = true;
                $('#txtStreet1').addClass('is-invalid');
            }
            else if(!strStreet2){
                blnError = true;
                $('#txtStreet2').addClass('is-invalid');
            }
            else if(!strCity){
                blnError = true;
                $('#txtCity').addClass('is-invalid');
            }
            else if(!strState){
                blnError = true;
                $('#txtState').addClass('is-invalid');
            }
            else if(!strZip){
                blnError = true;
                $('#txtZIP').addClass('is-invalid');
            }
            else if(!strStreet3 && checkBox.checked == true){
                blnError = true;
                $('#txtStreet3').addClass('is-invalid');
            }
            else if(!strStreet4 && checkBox.checked == true){
                blnError = true;
                $('#txtStreet4').addClass('is-invalid');
            }
            else if(!strCityC && checkBox.checked == true){
                blnError = true;
                $('#txtCityC').addClass('is-invalid');
            }
            else if(!strStateC && checkBox.checked == true){
                blnError = true;
                $('#txtStateC').addClass('is-invalid');
            }
            else if(!strZipC && checkBox.checked == true){
                blnError = true;
                $('#txtZIPC').addClass('is-invalid');
            }
            else {
                blnError = false;
                $('#txtEmail').removeClass('is-invalid');
                $('#txtEmail').addClass('is-valid');
                $('#txtPassword').removeClass('is-invalid');
                $('#txtPassword').addClass('is-valid');
                $('#txtFirstName').removeClass('is-invalid');
                $('#txtFirstName').addClass('is-valid');
                $('#txtLastName').removeClass('is-invalid');
                $('#txtLastName').addClass('is-valid');
                $('#txtStreet1').removeClass('is-invalid');
                $('#txtStreet1').addClass('is-valid');
                $('#txtStreet2').removeClass('is-invalid');
                $('#txtStreet2').addClass('is-valid');
                $('#txtCity').removeClass('is-invalid');
                $('#txtCity').addClass('is-valid');
                $('#txtState').removeClass('is-invalid');
                $('#txtState').addClass('is-valid');
                $('#txtZIP').removeClass('is-invalid');
                $('#txtZIP').addClass('is-valid');
                $('#txtStreet3').removeClass('is-invalid');
                $('#txtStreet3').addClass('is-valid');
                $('#txtStreet4').removeClass('is-invalid');
                $('#txtStreet4').addClass('is-valid');
                $('#txtCityC').removeClass('is-invalid');
                $('#txtCityC').addClass('is-valid');
                $('#txtStateC').removeClass('is-invalid');
                $('#txtStateC').addClass('is-valid');
                $('#txtZIPC').removeClass('is-invalid');
                $('#txtZIPC').addClass('is-valid');
            }
            if(blnError == false) {
                $.post('https://simplecoop.swollenhippo.com/coop.php').done(function(result){
                    const obj= JSON.parse(result);
                    strCoopID = obj.CoopID.toString();
                    $.post('https://simplecoop.swollenhippo.com/users.php',{Email:strEmail,Password:strPassword,FirstName:strFirstName,LastName:strLastName,CoopID:strCoopID}).done(function(result){
                        const obj = JSON.parse(result);
                        let tempStr = obj.Outcome.toString();
                        console.log(tempStr);
                        if (tempStr == 'User Not Created') {
                            Swal.fire ({
                                icon: 'error',
                                title: 'Uh oh..',
                                text: 'The credentials you entered are already in use.'
                        })
                        } else {
                            $('#divRegister').slideToggle();
                            $.post('https://simplecoop.swollenhippo.com/useraddress.php',{Email:strEmail, Street1:strStreet1, Street2:strStreet2, City:strCity, State:strState, ZIP:strZip}).done(function(result){
                                const obj = JSON.parse(result);
                                console.log(obj.Outcome);
                            })
                        
                            $.post('https://simplecoop.swollenhippo.com/sessions.php',{Email:strEmail, Password:strPassword}).done(function(result){
                                const obj = JSON.parse(result);
                                //console.log(result);
                                sessionStorage.setItem("SessionID",obj.SessionID);
                            })
                            //sessionStorage.getItem("SessionID");

                            $.ajax({
                                url: 'https://simplecoop.swollenhippo.com/coop.php',
                                type: 'PUT',
                                data: {SessionID:sessionStorage.getItem("SessionID"),Street1:strStreet3,Street2:strStreet4,City:strCityC,State:strStateC,ZIP:strZipC},
                                success: function (result) {
                                
                                }
                            });
                            //$.PUT('https://simplecoop.swollenhippo.com/coop.php',{SessionID:sessionStorage.getItem("SessionID"), Street1:strStreet3, Street2:strStreet4, City:strCityC, State:strStateC, ZIP:strZipC}).done(function(result){})
                            $('#divRegister').hide();
                            $('#divMain').show();
                    }})
                })
            }
        })

        $('#btnLogin').on('click', function() {
            let strEmail2 = $('#txtEmail2').val()
            let strPassword2 = $('#txtPassword2').val()
            let blnError2 = false;
            let strErrorMessage = '';
            /*
            $.getJSON('https://simplecoop.swollenhippo.com/users.php',{Email:strEmail2}).done(function(result){
                console.log(result);
            })
            */
            /*$.post('https://simplecoop.swollenhippo.com/environment.php',{SessionID:sessionStorage.getItem("SessionID"), observationDateTime:'Day 1', temperature:'12',humidity:'45'}).done(function(result){
                const obj = JSON.parse(result);   
                console.log(obj) ;
            })
            */

            if ($('#txtEmail2').val().length < 1) {
                blnError2 = true;
                $('#txtEmail2').addClass('is-invalid');
            } else {
                $('#txtEmail2').removeClass('is-invalid');
                $('#txtEmail2').addClass('is-valid');
            }
            if ($('#txtPassword2').val().length < 1) {
                blnError2 = true;
                $('#txtPassword2').addClass('is-invalid');
            } else {
                $('#txtPassword2').removeClass('is-invalid');
                $('#txtPassword2').addClass('is-valid');
            }
            if(blnError2 == false) {

                $.post('https://simplecoop.swollenhippo.com/sessions.php',{Email:strEmail2, Password:strPassword2}).done(function(result){
                    const obj = JSON.parse(result);
                    console.log(obj);
                    if(obj.SessionID) {
                        sessionStorage.setItem("SessionID",obj.SessionID);
                        console.log(sessionStorage.getItem("SessionID"));

                        $('#divMain').show();
                        $('#divLogin').slideToggle();
                        $('#divDashboard').slideDown();
                        $('#txtEmail2').removeClass('is-valid');
                        $('#txtPassword2').removeClass('is-valid');
                    }
                    else {
                        Swal.fire ({
                            icon: 'error',
                            title: 'Uh oh..',
                            text: 'Username or Password was Incorrecrt.'
                        })
                    }
                })
            }
        })

        $('#btnResetPassword').on('click', function() {
            let strEmail3 = $('#txtEmail3').val();
            let strNewPass = $('#txtNewPassword').val();

            let blnError3 = false;
            if ($('#txtEmail3').val().length < 1) {
                blnError3 = true;
                $('#txtEmail3').addClass('is-invalid');
            } else {
                $('#txtEmail3').removeClass('is-invalid');
                $('#txtEmail3').addClass('is-valid');
            }
            if ($('#txtNewPassword').val().length < 1) {
                blnError3 = true;
                $('#txtNewPassword').addClass('is-invalid');
            } else {
                $('#txtNewPassword').removeClass('is-invalid');
                $('#txtNewPassword').addClass('is-valid');
            }
            if(blnError3 == false) {
                let strFirstName ='';
                let strLastName = '';
                $.getJSON('https://simplecoop.swollenhippo.com/users.php',{Email:strEmail3}).done(function(result){

                    strFirstName = result.FirstName;
                    strLastName = result.LastName;
                })
                //console.log(JSON.stringify({'Email':strEmail3,'Password':strNewPass,'FirstName':strFirstName,'LastName':strLastName}));
                $.ajax({
                            url: 'https://simplecoop.swollenhippo.com/users.php',
                            type: 'PUT',
                            data: {Email:strEmail3,Password:strNewPass,FirstName:strFirstName,LastName:strLastName},
                            success: function (result) {
                                console.log(result);
                                $('#divForgotPassword').slideToggle();
                                $('#divLogin').slideToggle();
                            }
                        });
            }
        })    
    </script>
        <script>
            let txtEggs = 0;
            $.getJSON('https://simplecoop.swollenhippo.com/eggs.php',{SessionID:sessionStorage.getItem('SessionID'), days: 365}, function(result){
                console.log(result);
                if(result) {
                    if(result.length > 0) {
                        $.each(result,function(index,logEntry){
                            txtEggs = txtEggs + logEntry.Harvested;
                        })
                        document.getElementById("txtEggCount").innerHTML = txtEggs;

                    }
                }
            })
            const ctx = document.getElementById('myTempChart').getContext('2d');
            let arrTemp = [];
            let arrHumidity = [];
            let arrDates = [];
            $.getJSON('https://simplecoop.swollenhippo.com/environment.php',{SessionID:sessionStorage.getItem('SessionID'), days: 8}, function(result){
                console.log(result);
                if(result){
                    if(result.length > 0){
                        $.each(result,function(index,logEntry){
                            arrTemp.push(logEntry.Temperature);
                            arrHumidity.push(logEntry.Humidity);
                            arrDates.push(logEntry.ObservationDateTime);
                        })
                        document.getElementById("txtDegrees").innerHTML = arrTemp[result.length-1];
                        document.getElementById("txtHumidity").innerHTML = arrHumidity[result.length-1];
                        document.getElementById("txtCleanDays").innerHTML = 15
                        console.log(arrTemp);
                        console.log(arrHumidity);
                        console.log(arrDates);
                        new Chart(ctx, {
                            type: 'bar',
                            data: {
                            labels: arrDates,
                            datasets: [{
                                label: 'Temp',
                                data: arrTemp,
                                borderWidth: 1,
                                backgroundColor: '#FF0000',
                            },{
                                label: 'Humidity',
                                data: arrHumidity,
                                borderWidth: 1,
                                backgroundColor: '#0000FF',
                            }]
                            },
                            options: {
                            scales: {
                                y: {
                                beginAtZero: true
                                }
                            }
                            }
                        });
                    }
                }
            })
        </script>
</body>

</html>
